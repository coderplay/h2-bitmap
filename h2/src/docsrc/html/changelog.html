<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Copyright 2004-2010 H2 Group. Multiple-Licensed under the H2 License, Version 1.0,
and under the Eclipse Public License, Version 1.0
(http://h2database.com/html/license.html).
Initial Developer: H2 Group
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><title>
Change Log
</title><link rel="stylesheet" type="text/css" href="stylesheet.css" />
<!-- [search] { -->
<script type="text/javascript" src="navigation.js"></script>
</head><body onload="frameMe();">
<table class="content"><tr class="content"><td class="content"><div class="contentDiv">
<!-- } -->

<h1>Change Log</h1>

<h2>Next Version (unreleased)</h2>
<ul><li>-
</li></ul>

<h2>Version 1.2.137 (2010-06-06)</h2>
<ul><li>Statements with a nested query and a condition that was always NULL threw an
    IndexOutOfBoundsException. Example: select * from (select null as x) where x=1
</li><li>Experimental feature to support very large transactions (except when using MVCC).
    To enable, set the system property h2.largeTransactions to true.
    If enabled, changes to tables without a primary key can be buffered to disk.
    The plan is to enable this feature by default in version 1.3.x.
</li><li>H2 Console: editing result sets is now also working for database other than H2,
    if they do support updatable result sets. Add "@edit" before the query.
    Only limited testing has been done on this feature,
    some data types may not work (please provide feedback if you find issues).
</li><li>Cluster: an open transaction was committed when a cluster node was stopped
    (because disabling the cluster executes SET CLUSTER '', which committed the transaction).
    Transaction are no longer committed when calling SET CLUSTER. Issue 199.
</li><li>Cluster: non-admin users couldn't connect to the cluster and couldn't disable the cluster. Issue 201.
</li><li>Cluster: NEXTVAL('sequence') was only called on one cluster node,
    therefore sequence values could get out of sync.
</li><li>Version 1.2.136 could not be converted to Java 1.4
    (because the Retrotranslator doesn't support BigDecimal.precision).
    A workaround has been implemented.
</li><li>The error code of IO exceptions in CSV functions was incorrect.
</li><li>The TriggerPassData example now uses a prefix (the database name).
</li><li>The wrong exception was thrown when trying to reference a table that doesn't support references
    such as a table in the information schema.
</li><li>Server.shutdownTcpServer can now stop all TCP servers on this JVM.
</li><li>JdbcConnectionPool: the default connection timeout is now 30 seconds (it used to be 5 minutes).
</li><li>LOB storage: LOBs added with "h2.lobInDatabase" enabled couldn't
    be read later with this option disabled.
</li></ul>

<h2>Version 1.2.136 (2010-05-24)</h2>
<ul><li>When using ORDER BY and there are both ascending and descending indexes, the database used
    the first index even when the second one could be used for sorting.
</li><li>Conditions of the form columnName IS NULL now use an index. To disable this feature,
    set the system property h2.optimizeIsNull to false.
</li><li>H2 Console: when the settings were not stored yet (for example when running for the first time),
    the last recently used settings were not stored. A workaround was to create the file
    ".h2.server.properties" manually in the current user home directory, with the contents:
    webAllowOthers=false, webPort=8082, webSSL=false,
    0=Generic H2 (Embedded)|org.h2.Driver|jdbc\:h2\:~/test|sa
    (where a comma is a newline).
</li><li>The source code is now switched to Java 6 (JDK 1.6) by default.
    Java 5 (JDK 1.5) is still supported, and the jar file is still compiled for Java 5.
</li><li>The BOM (the byte-order-mark) character 0xfeff at the beginning of the file is ignored.
    This is for compatibility with Microsoft Excel.
</li><li>When opening an existing database, the cache size is set to at most
    half the amount of memory available for the virtual machine
    (Runtime.getRuntime().maxMemory()), even if the cache size setting stored in the database
    is larger. Setting the cache size in the database URL or explicitly using SET CACHE_SIZE
    overrides this value (even if larger than the physical memory).
</li><li>INFORMATION_SCHEMA.SETTINGS: the cache size is now returned in KB.
</li><li>New system property h2.selectForUpdateMvcc, the default is false (the feature is disabled).
    When enabled, SELECT ... FOR UPDATE only locks the selected rows in the MVCC mode.
    Aggregate or GROUP BY queries are not allowed in this case.
</li><li>Profiler: improved message if there was no stack trace.
</li><li>The H2 Console can now be used within another application, in a frame or iframe. Issue 197.
</li><li>Recover tool: the statistics section now includes page type counts again.
</li><li>Queries with multiple IN(...) conditions sometimes return the wrong results when there was a multi-column index for the column.
</li><li>Queries with IN(..., NULL) did sometimes return the wrong results when there was a index for the column.
</li><li>DECIMAL: faster precision and memory usage calculations.
</li><li>A new class org.h2.tools.TriggerAdapter allows to use the ResultSet interface within trigger implementations.
</li><li>A subselect which used an index could lead to wrong results. Fixed.
</li><li>Creating a cached temporary non persistent table with a primary key threw a NullPointerException.
</li></ul>

<h2>Version 1.2.135 (2010-05-08)</h2>
<ul><li>Temporary files were not deleted when using large transactions, disabling autocommit,
    and closing the session without committing.
</li><li>Queries using multiple IN(..) conditions on the same table could cause repeated rows in the result set.
</li><li>Translation: Lubomir Grajciar translated the H2 Console as well as all error message to Slovensky. Thanks a lot!
</li><li>There was a possible Java level deadlock when opening an uninitialized database and using
    a file system that also opened a database.
</li><li>When killing the process while the database was writing a checkpoint, while it was closing,
    or while running recovery (while removing temporary tables from a previous run), the database could become corrupt.
    A new test case has been implemented to ensure such problems can not occur in the future.
</li><li>File system: new method FileSystem.setReadOnly.
</li><li>The page size for new databases can now be set in the database URL using ;PAGE_SIZE=512.
    Currently this feature is only used to simplify testing.
</li><li>New system property h2.functionsInSchema (default is false).
    If enabled, the SCRIPT statement always includes the schema name in the CREATE ALIAS statement
    (even if the schema is PUBLIC). This is not backward compatible with H2 versions 1.2.134 and older.
</li><li>Functions: it is no longer required to add a space after a comma in the parameter list.
    Example: CREATE ALIAS PARSE_INT FOR "java.lang.Integer.parseInt(java.lang.String,int)"
</li><li>Functions now reside within a schema, similar to sequences.
    If you do create such functions in schemas other than PUBLIC, then the database
    can not be opened with older versions of H2.
</li><li>Cluster: after a cluster node failed, the second cluster node can now be re-created
    and started without having to stop the first cluster node, and without having to stop
    running applications. To do that, append ;AUTO_RECONNECT=TRUE to the database URL.
</li><li>Auto-reconnect: if another connection uses the database in exclusive mode
    then this connection will try to re-connect until the exclusive mode ends.
    This is important when using the cluster mode.
</li><li>SET EXCLUSIVE now supports 0 (disable), 1 (enable), and 2 (enable and close all other connections).
</li><li>Installing the H2 as a service should now work on Windows 7.
    The batch files now explicitly set the directory using pushd "%~dp0".
</li><li>Temporary tables can now be 'cached', that means indexes of temporary tables
    can be persisted. This enables very large temporary tables (both local and global).
</li><li>The CreateCluster tool now sets the source database in exclusive mode
    before copying data to the new database.
</li><li>The H2 Console now stream results one statement / result set at a time (using chunked transfer encoding).
    To disable, set the system property h2.consoleStream to false.
    This feature is not supported when using a servlet container.
</li><li>The H2 Console did not call the CreateCluster tool with the correctly escaped parameters.
</li><li>Improved PostgreSQL compatibility for ALTER TABLE ALTER COLUMN.
</li><li>Commas at the end of INSERT ... VALUES (), (), are now supported.
</li><li>The H2 Console "Start Browser" button now works even when the IP
    address changes while the tool runs (for example, because a wireless connection
    breaks, or when enabling / disabling the network connection).
</li><li>When casting from float or double to BigDecimal, the result was
    sometimes unexpected, because "new BigDecimal(double val)" was used.
    Now "BigDecimal.valueOf(double val)" and "new BigDecimal(Float.toString(f))" are used.
    But it is still not recommended to use float or double for currency values
    (see data type documentation).
</li><li>Global temporary tables are now deleted when closing the database.
    Before, they were deleted when opening the database the next time.
</li><li>UNIQUE was not listed as a keyword.
</li><li>Improved error message when an non-SQL-exception occurred in a user
    defined function. The method name and parameters are included in the error message.
</li><li>For some queries, the exception did not include the SQL statement. Example:
    select x from system_range(1, 2) group by 'a'.
</li><li>The Shell tool will execute SQL statements passed as using the command line
    parameter -sql.
</li><li>If InetAddress.getLocalHost() fails, the database should now throw an exception.
</li><li>New columns INFORMATION_SCHEMA.INDEXES.INDEX_CLASS and
    INFORMATION_SCHEMA.TABLES.TABLE_CLASS.
</li><li>INFORMATION_SCHEMA.INDEXES.SQL now contains the CREATE INDEX statement
    instead of just the fully qualified index name.
</li></ul>

<h2>Version 1.2.134 (2010-04-23)</h2>
<ul><li>New system property h2.analyzeAuto (default 0 meaning disabled) to
    automatically run ANALYZE after that many changes to a table.
    For details, see the Javadoc of this system property.
    The plan is to set this property to 2000 in version 1.3.x.
</li><li>JdbcXAConnection.start() does not support TMJOIN. Issue 189.
</li><li>MySQL compatibility: TIMESTAMPDIFF is now an alias for DATEDIFF.
</li><li>MERGE did not respect foreign key and check constraints.
</li><li>ALTER TABLE ALTER COLUMN: changing the data type of a column
    no longer makes it nullable.
</li><li>When using AUTO_SERVER=TRUE, the server is now started as a daemon thread.
    This was a problem when using Tomcat and a connection pool.
</li><li>Servers can now be started as a daemon thread using the command line options
    -tcpDaemon, -pgDaemon, and -webDaemon.
</li><li>H2 Console: the built-in commands are now documented.
</li><li>REPLACE: if any parameter is null, the result is null.
</li><li>Queries with DISTINCT and ORDER BY will now use the index on ORDER BY if possible.
    This is specially important for queries used inside IN(SELECT ...).
</li><li>The new statement EXPLAIN ANALYZE executes the statement,
    and displays the query plan with the actual row scan count for each table.
</li><li>H2 Console: the auto-complete feature didn't quote column names
    that need quoting. Issue 186.
</li><li>The experimental LOB storage mechanism now supports all features of the
    old one. To use it, set the system property "h2.lobInDatabase" to "true".
    If you have used this feature in version 1.2.133, you need to export
    and re-import the database using SCRIPT / RUNSCRIPT.
</li><li>The functions isBeforeFirst() and isAfterLast() were not compliant to the
    JDBC spec. If the ResultSet contains no rows, they must return false. Fixed.
</li><li>Filesystem parameters like "split:" didn't work in server mode with baseDir set.
</li><li>If baseDir is set, and a database name is given which points to a directory outside
    the baseDir (eg. "../dbname"), an exception is thrown.
</li></ul>

<h2>Version 1.2.133 (2010-04-10)</h2>
<ul><li>A new experimental LOB storage mechanism is available.
    When enabled, CLOB and BLOB data is stored in hidden tables in the database.
    To use it, set the system property "h2.lobInDatabase" to "true".
    Compression is not yet implemented. Duplicate objects are only stored once.
    Usually writing is slower, but reading is faster (mainly because of caching).
</li><li>The Shell tool threw a NumberFormatException on a empty statement.
</li><li>The h2small-*.jar did not support "drop all objects delete files".
    Now it is supported (the DeleteDbFiles tool is now included).
</li><li>Operations that don't fit in memory are now faster.
    Temporary file handling was changed.
</li><li>The default maximum log stream size is now 2 MB. This is a good value
    according to some performance tests.
</li><li>New system property "h2.syncMethod" to configure what method to call when
    closing the database, on checkpoint, and on CHECKPOINT SYNC. The default is "sync" which
    calls RandomAccessFile.getFD().sync().
</li><li>ROWNUM could not be used for pagination. The follow query returned no rows:
    select x from (select *, rownum as r from system_range(1, 3)) where r=2;
</li><li>Workaround for a java.sql.Date issue: years above 9999 are not formatted correctly.
    When calling ResultSet.getString() on a date value, an alternative formatting algorithm is used.
</li><li>Prepared statements with nested subqueries did not always return the correct result. Example:
    select ?, ?, (select count(*) from test t, (select id from test where 0=?) t2 where t2.id=t.id) from test
</li><li>When using MULTI_THREADED=TRUE, the exception following exception could be thrown:
    "object already exists: TABLES"
</li><li>Comparison of integer columns against float numbers was not always correct. Issue 182.
</li><li>H2 Console: Editing the result of a multi-line queries failed. Issue 183.
</li><li>H2 Console: if the settings file (.h2.properties) can't be accessed, the exception is now ignored.
</li></ul>

<h2>Version 1.2.132 (2010-03-21)</h2>
<ul><li>The implementation of a Java to C (source code level) converter has been started.
    The plan is: it should be possible to convert H2 (or a part of it) to C so that the database
    can be run without a JVM. This will be a long term project (it may take a year or so).
</li><li>User defined table implementation can now be used using CREATE TABLE ... ENGINE.
    Thanks to Sergi Vladykin for implementing this feature!
</li><li>Improved MS SQL Server compatibility: support string concatenation using "+".
    Thanks to Stepan for the patch!
</li><li>When using the multi-threaded mode, running ANALYZE concurrently in multiple
    connections could throw an exception.
</li><li>The MERGE statement is now about 30% faster when using a PreparedStatement.
</li><li>Multi-column indexes where the second or later column was descending did not always
    produce correct results (rows were missing in the result set, or the result set was empty).
</li><li>When using large transactions or a small log size, the database could get very slow
    (profiling shows the hotspot is in FileObjectDisk.sync()).
</li><li>The Shell tool now prints the stack trace when the list mode is enabled.
</li><li>CREATE ALIAS ... AS: Compilation was incorrect if the source code contained
    characters that are not supported by the default file encoding.
</li><li>Issue 176: the JdbcDataSource now also supports a 'description' property.
</li><li>The Shell tool threw a ArrayIndexOutOfBoundsException after 20 statements.
</li><li>When using the small version of H2 ('jarClient'), the first call to
    Connection.createBlob (or similar) could throw a ClassNotFoundException
    because the file org.h2.store.fs.FileSystemZip is not included. This missing class
    is now ignored.
</li><li>Literals of type BIGINT now have the correct data type.
</li></ul>

<h2>Version 1.2.131 (2010-03-05)</h2>
<ul><li>Older versions of H2 (version 1.2.127 and older) could not connect to a new version (version 1.2.129 and newer).
    The connection blocked when trying to connect. Now the connection no longer blocks, instead a SQL exception is thrown.
</li><li>In versions 1.2.129 and 1.2.130, a database could not be opened sometimes
    after dropping tables or indexes, and then creating new indexes for existing tables.
    The exception contained the text "parent not found" (version 1.2.129) or
    "Table not found" (version 1.2.130).
</li><li>After the database was closed, a null pointer exception could occur in Database.flush.
</li><li>An ArrayIndexOutOfBoundsException could occur in the page store (eg. on "delete from table"). Fixed.
</li></ul>

<h2>Version 1.2.130 (2010-02-26)</h2>
<ul><li>EXPLAIN: The query plan now contains ".tableScan" if a table scan is used.
</li><li>IN(..): when combining and IN(..) condition with a condition that didn't use an index,
    the result could contain duplicate rows.
</li><li>IN(..): the index was not used if there were multiple IN(..) conditions.
</li><li>For foreign key constraints, the metadata column
    INFORMATION_SCHEMA.INDEXES.CONSTRAINT_NAME was not set for non-unique indexes.
</li><li>PostgreSQL compatibility: when using the following exception was thrown:
    Column "T.TYPTYPMOD" not found. Fixed. This is only when using psqlodbc_08_04*.
</li><li>A tool to migrate an old database from the non-page store format to the
    newest version has been added in src/tools/org/h2/dev/util/Migrate.java. This file is not
    included in the jar file currently.
</li><li>When using temporary tables, the database didn't shrink sometimes when closing.
    Also, sometimes a database could not recover normally.
</li><li>Large transactions could run out of heap space. The maximum size of a transaction is now much larger.
</li><li>The default setting for the system property h2.webMaxValueLength is now 100000 (it was 10000 before).
</li><li>Creating a database was delayed about 2 seconds if the directory didn't exist.
</li><li>Implemented INIT feature. If the database URL contains ";INIT=...;" then the DDL or DML commands
    following are executed on startup. Example URL: jdbc:h2:mem:test;INIT=RUNSCRIPT FROM '~/create.sql'
    (patch from Kerry Sainsbury).
</li></ul>

<h2>Version 1.2.129 (2010-02-19)</h2>
<ul><li>The methods of the CloseListener are added to the Trigger interface.
    The interface CloseListener is removed. This is potentially a breaking change for existing triggers.
</li><li>CREATE ALIAS: error message when compiling Java code have been improved.
</li><li>MVCC: creating a table with an incorrect constraint could cause strange errors.
</li><li>Hash indexes now are only used for single column indexes.
</li><li>The cache types WEAK_* and TQ are no longer supported.
    A weak reference cache never frees up memory so it's the same as
    having a very large cache size. The TQ cache was not included in the
    jar file since a longer time, and was not tested.
</li><li>The file system abstraction no longer throws SQL exceptions.
</li><li>DatabaseEventListener.diskSpaceIsLow has changed.
</li><li>The CompressTool no longer throw as SQL exceptions. Instead, it throws runtime exceptions.
</li><li>SimpleResultSet.addColumn and addRow now can throw a IllegalStateException
    instead of a SQLException.
</li><li>When doing an index lookup, decimal values with the same value but different scale
    (for example 0.00 and 0.0) where not considered equal in version 1.2.128.
    Now they are (unlike BigDecimal.equals()).
</li><li>The BNF parser now uses the visitor pattern.
</li><li>Converting a UUID to bytes was incorrect. Because of that, updatable result sets on
    tables with UUID primary key did not work.
</li><li>The database URL property DATABASE_EVENT_LISTENER_OBJECT is no longer supported
    (there are problems passing objects when the PostgreSQL driver is installed as well).
</li><li>H2 Console: asynchronous login (using a DatabaseEventListener) is no longer supported.
</li><li>A workaround for a Windows socket problem has been implemented. Thanks a lot to Sergi Vladykin.
</li><li>The Recover tool did not convert correctly convert CLOB data with non-ASCII characters.
</li><li>Tools: the method run(String... args) has been renamed to runTool(String... args).
</li><li>Server.startWebServer(Connection) was not working as expected.
</li><li>The database URL option ACCESS_MODE_LOG is no longer supported.
</li><li>The database URL option RECOVER has currently no effect.
</li><li>Converting an old (non-page store) database is no longer supported using this version.
</li><li>The following system properties are no longer supported:
    h2.overflowExceptions, h2.optimizeDropDependencies, h2.optimizeGroupSorted,
    h2.optimizeMinMax, h2.optimizeNot, h2.optimizeIn, h2.optimizeInJoin, h2.reuseSpace*.
    Most of then were there for a long time, but always with the same value.
    There was no unit test with the other value. So changing them was potentially dangerous
    (not a lot, but still).
</li><li>The setting LOG has currently no effect (it only had an effect when the page store was disabled).
</li><li>Disabling the page store is no longer supported. The old storage mechanism
    has been removed, shrinking the jar file size by almost 10%.
</li><li>The translated resources are now stored in UTF-8 format.
</li><li>The Windows service wrapper now detects if multiple versions of H2 are installed.
</li></ul>

<h2>Version 1.2.128 (2010-01-30)</h2>
<ul><li>There are known errors on rollback when the page store is disabled and at the same time
    MVCC is used. See http://code.google.com/p/h2database/issues/detail?id=158
</li><li>The DeleteDbFiles tool deleted all files in the .lob.db directory,
    even files that didn't belong to the database.
</li><li>Automatic conversion of old databases to the page store format failed
    if the database contained LOB files.
</li><li>Nested subqueries didn't work for INSERT INTO and IN(..).
    Example: insert into test ((select 1));
</li><li>If the database was already closed using SHUTDOWN IMMEDIATELY, closing a second
    connection could throw a NullPointerException if there was a local temporary table.
</li><li>Less classes are loaded when using the database in embedded mode.
</li><li>The information schema tables are only initialized when needed.
    This reduces memory usage and speeds up creating in-memory databases.
    Each in-memory database needs about 8 KB of heap memory.
</li><li>Nested UNION/INTERSECT queries with brackets could produce the wrong result if used within a subquery. Example:
    select count(*) from (select 1 union (select 2 intersect select 2)) x;
</li><li>Comparing an column against a constant expression with a higher precision or length
    than the column could give wrong results (the expression was truncated before comparing).
</li><li>Improved PostgreSQL compatibility (support SHOW DEFAULT_TRANSACTION_ISOLATION).
</li><li>Documentation: the javadocs for Csv.write and read used the wrong default charset.
</li><li>MVCC: if the table was locked in exclusive mode (such as SELECT ... FOR UPDATE), another session
    could query the table. This is now longer possible.
</li><li>If a FOR UPDATE query was executed twice (using a PreparedStatement), the table was not locked.
</li><li>Triggers: INSTEAD OF triggers are now supported.
    Such triggers can be defined on views.
</li><li>New system property h2.identifiersToUpper. If set to false,
    identifiers in SQL statements are case sensitive even if they are not quoted.
</li><li>Slightly improved performance if the table is already locked.
</li><li>CompressLZF: faster decompression.
</li><li>PgServer: the wrong size was sent for VARCHAR data.
    Thanks again to Sergi Vladykin for the patch.
</li><li>Serialized access mode (server-less multi-connection mode): fixed getGeneratedKeys() for sequences.
</li></ul>

<h2>Version 1.2.127 (2010-01-15)</h2>
<ul><li>Serialized access mode (server-less multi-connection mode): sequences did not work as expected
    (there were gaps in generated values when using multiple connections).
</li><li>Page store: new databases can not be opened with older versions.
</li><li>Page store: adding data to new database is now faster.
</li><li>File system: getting the file name from a path is now faster. This should
    speed up BLOB and CLOB access.
</li><li>PgServer: incorrect SQL types were returned in result set meta data.
    Concurrently opening a database could fail (PG catalog initialization was not synchronized).
    Thanks a lot to Sergi Vladykin for providing the patches!
</li><li>SHOW COLUMNS did not work correctly if there where multiple indexes
    on the same columns.
</li><li>Page store: the wrong write count was written to the database header.
    This could cause the server-less multi-connection mode to fail.
</li><li>Result sets larger than 2 GB threw an exception "Negative seek offset". Fixed.
</li><li>If the system property h2.check was set to false, an ArrayIndexOutOfBoundsException could occur.
</li><li>Alter table is now supported even if a table has views defined.
</li><li>Fulltext search: exceptions within the fulltext search package had the wrong SQL state.
</li><li>The Lucene fulltext search ignored transaction rollback. Fixed using a trigger on rollback.
</li><li>Trigger can now be called on rollback.
</li><li>The shell script h2.sh ignored command line line arguments.
</li><li>When running H2 in the Google AppEngine for Java, a AccessControlException could be thrown
    when trying to open a read-only database. Fixed.
</li><li>The user home directory prefix (~) is now only expanded when followed by a slash
    or backslash, or standing alone.
</li><li>Native fulltext search: before inserting or deleting data, FT_INIT() had to be called.
    This is no longer required.
</li><li>The .trace.db file is now only created if required.
</li><li>Shell tool: improved PostgreSQL compatibility.
</li><li>Trying to open a database in read-only mode when a .lock.db file exists will now fail
    with a nice error message.
</li><li>H2 Console: data that is too long is now abbreviated as follows: text... (100000 characters).
    A large binary is abbreviated as follows: abcdef... (100000 bytes).
</li><li>Faster data conversion from BIGINT or INT to DECIMAL.
</li><li>Server-less multi-connection mode: try to delete log files if switching between read/write operations.
</li><li>CompressLZF: Faster decompress and improved javadocs
</li></ul>

<h2>Version 1.2.126 (2009-12-18)</h2>
<ul><li>The ChangeFileEncryption tool will now fail with an exception
    if the database is still in use. The Backup tool will also fail except when running in quiet mode.
</li><li>CSVREAD: when reading the column names from the CSV file, column names that contain
    no special characters are considered case insensitive now.
</li><li>Optimization index conditions of the form 'column=NULL' (which is always false; unlike 'column IS NULL').
</li><li>Script command and tool: the primary key constraint is now listed before inserting the data.
    This will result in a smaller database when using the page store.
</li><li>Statements with IN(SELECT..) conditions could produce the wrong result.
    Example: index on id, name; query: select * from test where id between 1 and 3 and name in (select 'World').
</li><li>Statements with IN(..) conditions could produce the wrong result when using views or nested select statements.
    Example: index on id; index on name; query: select * from (select * from test) where id=1 and name in('a', 'b').
    select * from (select * from test) where id=1 and name in('Hello', 'World').
</li><li>Page store: a rollback of a relatively large transaction could fail with an ArrayIndexOutOfBoundsException
    or a 'row not found' exception in the PageBtreeIndex in some cases.
</li><li>JaQu: the decompiler has been improved, and a few test cases already work. It is still incomplete however.
</li><li>LIKE: any letter is now allowed after the escape character (which is still '\' by default).
    Previously, an exception was thrown (unlike other databases) if it was not the escape character, '_' or '%'.
    If the escape character appears at the end of the pattern, the result is  it is ignored (like PostgreSQL and MS SQL Server).
</li><li>The reserve heap memory is no longer used.
</li><li>Database.checkpoint() could throw a NullPointerException.
</li></ul>

<h2>Version 1.2.125 (2009-12-06)</h2>
<ul><li>Lucene fulltext search: the Lucene field names now match the table column names,
    except if the column names start with _ (in which case another _ is prepended).
    Unfortunately this change means existing fulltext indexes need to be re-built.
</li><li>The shell tool now has a very simple statement history.
</li><li>The zip file system implementation now supports the '~' home directory prefix.
    Example database URL: jdbc:h2:zip:~/test.zip!/test
</li><li>Right outer joins on tables that were already 'inner joined' was processed incorrectly.
</li><li>Temporary files from LOB objects were not deleted early enough when using the server mode.
</li><li>Trying to alter a temporary table threw a strange exception.
    It is still not possible to do that, but the exception message is better now.
</li><li>When the system property h2.maxMemoryRowsDistinct was set, and
    using SELECT DISTINCT, the temporary table was not correctly dropped.
    This could cause problems in recovery when the process was killed.
</li><li>Trigger that are called before a select statement are now supported.
    This allows to create tables that work like materialized views.
</li><li>Non-row based triggers were called even if the action didn't match the
    declared action (INSERT triggers were also called when deleting rows).
    This has been changed. The MERGE statement calls both INSERT and DELETE triggers.
</li><li>Statements with IN(..) conditions could produce the wrong result or a data conversion error (since version 1.2.120).
    Examples: index on id, name, condition: id=1 and name in('Hello', 'x'); index on id, query:
    select * from (select * from test) where id=1 and name in('Hello', 'World').
</li><li>The CompressTool was not multithreading safe. Because of this, the following database
    operations where also not multithreading safe (even when using different databases): the SCRIPT command
    (only when using compression), the COMPRESS function, and storing CLOB or BLOB data (only when compression is enabled).
</li><li>The compression algorithm "LZF" is now about 33% faster than before when compressing small block
    (around 2 KB). It is much faster than Deflate, but the compression ratio is lower.
    Some of the optimizations are from Sam Van Oort, thanks a lot!
</li><li>Compressing large blocks of data didn't work when using the "Deflate" compression algorithm.
    Compressing a lot of data could run out of heap memory.
</li><li>The test cases don't access the file system directly, this simplifies GAE for Java testing.
    Thanks to Vince Bonfanti.
</li><li>More bugs in the server-less multi-connection mode have been fixed.
</li><li>When running against an old database, the SCRIPT statement could generate a
    SQL script that contained duplicate indexes (PRIMARY_KEY_E).
</li><li>JdbcConnectionPool.getConnection() could throw a NullPointerException.
</li><li>User defined functions: the source code is now available using
    SELECT SOURCE FROM INFORMATION_SCHEMA.FUNCTION_ALIASES.
</li><li>User defined functions with source code didn't work after re-opening the database.
</li><li>The newsfeeds are now Atom 1.0 standard compliant.
</li><li>The database is now closed after an out of memory exception, because
    the database could get corrupt otherwise.
</li><li>Better error message if both AUTO_SERVER and SERIALIZED parameters are set to TRUE.
</li><li>Drop table did not delete lob files in old file store (not PAGE_STORE).
</li></ul>

<h2>Version 1.2.124 (2009-11-20)</h2>
<ul><li>Clustering: there is now a way to detect which cluster instances are running.
</li><li>ConvertTraceFile: the SQL statement statistics are better formatted (newline are removed).
</li><li>The file lock thread is now stopped when the database is closed.
</li><li>Issue 140: the Script tool now supports writing to a stream.
</li><li>Issue 138: the trace output of Statement.execute(String, int) and executeUpdate was incorrect.
</li><li>Page store: new databases can not be opened with older versions.
</li><li>Page store: multi-column indexes didn't work if the cache was very small.
</li><li>Page store: opening a database could theoretically result in an endless loop.
</li><li>Page store: adding large indexed columns could get very slow.
</li><li>Page store: after a duplicate key exception, an ArrayIndexOutOfBoundsException could be thrown (only for very large rows).
</li><li>Page store: the recover tool sometimes generated a script file that contained duplicate data.
</li><li>Page store: sometimes opening a read-only database failed.
</li><li>Page store: opening a database sometimes failed if large rows where updated, or if a table was truncated before.
</li><li>Page store: when using a very small page size (128 bytes or smaller), writing a large row could result in an endless recursion. This is only a theoretical problem, as the page size is 2 KB.
</li><li>Page store: getting the min value from a descending index with NULL entries could return the wrong result.
</li><li>Page store: improved auto-recovery after power failure.
</li><li>The JDBC client did not detect that it was not talking to an H2 server. This could result in strange exceptions when trying to connect to another kind of server.
</li><li>User defined functions can be created with source code. Example: CREATE ALIAS HI AS 'String hi() { return "Hello"; }'
</li><li>Database file lock: the exception "lock file modified in the future" is no longer thrown; instead, opening the file will be delayed by 2 seconds.
</li><li>Inserting LOBs got slower each time the process was restarted. It could loop endlessly after about 1000 process restarts.
</li><li>Issue 117: Multi-version concurrency: concurrent MERGE statements now work.
</li><li>Improved read-only database detection.
</li></ul>

<h2>Version 1.2.123 (2009-11-08)</h2>
<ul><li>Page store: new databases can not be opened with older versions.
</li><li>Page store: updating large rows (rows with more than 2000 bytes of data)
    could corrupt the database.
</li><li>Page store: inserting very large rows failed with ArrayIndexOutOfBoundsException.
</li><li>When using multi-threaded kernel mode, setting disabling locking (LOCK_MODE=0)
    will now throw an exception. At this time this combination will result in corruption when
    multiple threads try to update the same table.
</li><li>The fulltext search methods and fields are now protected instead of private,
    to make the classes more easily extensible.
</li><li>The Lucene fulltext search now also returns the score.
</li><li> New function SCOPE_IDENTITY() to avoid problems when inserting
    rows in a trigger.
</li><li>Statement.getGeneratedKeys() returned the wrong value if a trigger
    changed the identity value after inserting the row.
</li><li>Improved error messages: identifiers and values are now quoted.
</li><li>Improved error message when casting a value failed:
    the column name and type is included in the message.
</li><li>Improved support for GAE for Java thanks to Vince Bonfanti.
</li></ul>

<h2>Version 1.2.122 (2009-10-28)</h2>
<ul><li>The native fulltext search now supports streaming CLOB data.
</li><li>If the database URL ends with ;PAGE_STORE=TRUE and a database in
    the old format exists, it is automatically converted to the new page store format
    if possible. A backup of the database is created first. Automatic conversion is not supported
    if the database was not closed normally (if it contains uncommitted transactions).
</li><li>Dropping the current user is now allowed if another admin user exists.
</li><li>Values of type BINARY or BLOB could not be converted to the data type OTHER.
</li><li>SHUTDOWN COMPACT now fully compacts the database.
</li><li>New system properties h2.maxCompactCount and h2.maxCompactTime
    to allow changing the default behavior (at most 2 seconds compacting when closing the database).
</li><li>New sorted insert optimization (see Performance / Database Performance Tuning).
</li><li>Issue 116: The files h2*-sources.jar and h2*-javadoc.jar are
    now in the Maven repository.
</li><li>Page store: opening a large database was slow if it was not closed before.
</li><li>Page store: new write and read counters in the meta data table. Use
    SELECT * FROM INFORMATION_SCHEMA.SETTINGS WHERE NAME IN(
    'info.FILE_WRITE_TOTAL', 'info.FILE_WRITE', 'info.FILE_READ',
    'info.CACHE_MAX_SIZE', 'info.CACHE_SIZE')
</li><li>The SQL syntax is documented using (railroad) diagrams.
    The diagrams are HTML.
</li><li>The documentation is no longer available in Japanese because the
    translation was too much out of sync. Please use the Google translation instead.
</li><li>Certain queries were not sorted if subselect queries were involved
</li><li>More bugs in the server-less multi-connection mode have been fixed:
    90097 The database is read only, caches must be cleared on reconnect, etc.
</li></ul>

<h2>Version 1.2.121 (2009-10-11)</h2>
<ul><li>Better support GaeVFS (Google App Engine Virtual File System) thanks to Thanks to Vince Bonfanti.
</li><li>CSVREAD didn't close the file. Thanks to Vince Bonfanti for the patch!
</li><li>If a database in the old format exists, it is now used.
    The system property is used for new databases, or if databases exist
    in both formats. In any case, the flag in the URL overrides this logic.
</li><li>Page store bugs were fixed. Large values in indexed columns could corrupt the index.
</li><li>The page store did not work when using Retrotranslator (because the Retrotranslator doesn't
    support Integer.reverse and Long.reverse).
</li><li>New system property h2.pageStoreTrim to disable shrinking the database when closing
    (disabled by default, meaning by default the database is trimmed).
</li></ul>

<h2>Version 1.2.120 (2009-10-04)</h2>
<ul><li>This is a beta version.
</li><li>Large updates could throw an ArrayIndexOutOfBoundsException in RowList.writeRow.
</li><li>In version 1.2, the following system properties are now enabled by default:
    h2.pageStore, h2.nullConcatIsNull, h2.optimizeInList. The default value for
    h2.defaultMaxLengthInplaceLob is now 4096 (it was 1024 with version 1.1).
</li><li>New databases are now stored in the new 'page store' file format.
    Existing databases are kept in the old file format. To use the old file format,
    append ;PAGE_STORE=FALSE to the database URL or set the system property h2.pageStore to false.
</li><li>Issue 125: Renaming primary keys was not persistent. Fixed.
    Unfortunately, databases created by this version can not be opened with older versions because of this change.
</li><li>Issue 124: Hibernate schema validation failed for decimal/numeric columns.
    This problem is fixed in the Hibernate dialect that is included with H2
    (src/tools/org/hibernate/dialect/H2Dialect.java.txt), but not in Hibernate yet.
</li><li>PostgreSQL compatibility: function LASTVAL() as an alias for IDENTITY().
</li><li>Linked tables now support default values when inserting, updating or merging.
</li><li>Bugfixes in the page store.
</li><li>Possibility to set a vendor id in Constants.java, so that unofficial builds are distinguishable
    from official releases.
</li><li>Allow writing to linked tables in readonly databases.
</li></ul>

<h2>Version 1.1.119 (2009-09-26)</h2>
<ul><li>SQL statements in the exception message are no longer included if they contain '--hide--'.
</li><li>Temporary local tables did not always work after reconnect if AUTO_SERVER=TRUE
</li><li>New system property h2.defaultMaxLengthInplaceLob to change the default maximum size
    of an in-place LOB object.
</li><li>New system property h2.nullConcatIsNull to change the default null concatenation behavior.
    The default will be enabled in version 1.2.
</li><li>The cache algorithm TQ is disabled in this version, because it is unstable, and
    because the current implementation does not have any measurable advantages over the default.
</li><li>New committer: Christian Peter. He works for <a href="http://www.docware.com">Docware</a> and
    helped a lot finding and fixing bugs, and generally improving the database. He is now a committer.
</li><li>ChangeFileEncryption did not work with Lob subdirectories. Fixed.
</li><li>Issue 121: JaQu: new simple update and merge methods.
</li><li>Issue 120: JaQu didn't close result sets.
</li><li>Issue 119: JaQu creates wrong WHERE conditions on some inputs.
</li><li>The new page store mechanism is now alpha-level quality. The next release
    will most likely be "1.2.120 beta" where this mode is enabled by default. To use
    it right now, append ;PAGE_STORE=TRUE to the database URL. The file format
    of this mode will probably not change any more.
</li><li>SELECT COUNT(*) FROM SYSTEM_RANGE(...) returned the wrong result. Fixed.
</li><li>The Recover tool now also processes the log files, however applying those changes
    is still a manual process.
</li><li>New sample application that shows how to pass data to a trigger.
</li><li>More bugs in the server-less multi-connection mode have been fixed:
    On Windows, two processes could write to the same database at the same time.
</li><li>When loading triggers or other client classes
    (static functions, database event listener, user aggregate functions, other JDBC drivers),
    the database now uses the context class loader if the class could not be found using Class.forName().
</li><li>Updating many rows with the same CLOB or BLOB values could result in FileNotFoundException.
</li><li>Statement.getConnection() threw an exception if the connection was already closed.
</li><li>The native fulltext index kept a reference to a database after the database was closed.
</li><li>Non-unique in-memory hash indexes are now supported. Thanks a lot to Sergi Vladykin for the patch!
</li><li>The optimizer does a better job for joins if indexes are missing.
</li></ul>

<h2>Version 1.1.118 (2009-09-04)</h2>
<ul><li>SHOW COLUMNS only listed indexed columns.
</li><li>When calling SHUTDOWN IMMEDIATELY in the server mode, the .trace.db file was not closed.
</li><li>DatabaseMetaData.getPrimaryKeys: the wrong constraint name was reported
    if there was another constraint on the same table and columns.
</li><li>AUTO_INCREMENT now works in the same way in ALTER TABLE ALTER COLUMN
    as in CREATE TABLE (it does not create a primary key).
</li><li>Native fulltext search: before searching, FT_INIT() had to be called.
    This is no longer required.
</li><li>Better support GaeVFS (Google App Engine Virtual File System).
</li><li>JaQu: the plan is to support natural (pure Java / Scala) conditions such as
    (id == 1 &amp;&amp; name.equals("Test")). A proof of concept decompiler is now included (it doesn't work yet).
</li><li>Various bugfixes and improvements in the page store mechanism (still experimental).
</li><li>PreparedStatement.setObject now converts a java.lang.Character to a string.
</li><li>H2 Console: PierPaolo Ucchino has completed the Italian translation. Thanks a lot!
</li><li>Various tools now use Java 5 var-args, such as main the methods and SimpleResultSet.addRow.
</li><li>H2 Console: indexes of tables of non-default schemas are now also listed.
</li><li>Issue 111: Multi-version concurrency / duplicate primary key after rollback.
</li><li>Issue 110: Multi-version concurrency / wrong exception is thrown.
</li><li>Parser: sequenceName.NEXTVAL and CURRVAL did not respect the schema search path.
</li><li>Issue 101: The following sequence could throw the exception "Row not found when trying to delete":
    start a transaction, insert many rows, delete many rows, rollback. The number of rows depends
    on the cache size.
</li><li>The stack trace of very common exceptions is no longer written to the .trace.db file by default.
</li><li>An optimization for OR is implemented, but disabled by default.
    Expressions of the type X=1 OR X=2 are converted to X IN(1, 2).
    To enable, set the system property h2.optimizeInList to true before loading the H2 JDBC driver.
</li><li>An optimization for IN(..) and IN(SELECT...) is implemented, but disabled by default.
    To enable, set the system property h2.optimizeInList to true before loading the H2 JDBC driver.
    If enabled, this overrides h2.optimizeIn and h2.optimizeInJoin. Unlike now, this optimization
    will also speed up updates and deletes.
</li></ul>

<h2>Version 1.1.117 (2009-08-09)</h2>
<ul><li>New committer: Sam Van Oort has been contributing to H2 since quite some time
    in many ways (on the mailing list, documentation, and in the form of patches).
    He is now a committer.
</li><li>JaQu: the order of the fields in the database no longer needs to match the order in the database.
</li><li>Issue 103: MVCC: the setting MAX_MEMORY_UNDO can currently not be supported when using
    multi-version concurrency, that means the complete undo log must fit in memory.
</li><li>LIKE: the escape mechanism can now be disable using ESCAPE ''.
    The default escape character can be changed using the system property h2.defaultEscape.
    The default is still '\' (as in MySQL and PostgreSQL).
</li><li>Views using functions were not re-evaluated when necessary.
</li><li>Improved MySQL compatibility for SHOW COLUMNS.
</li><li>Improved PostgreSQL compatibility for timestamp literals with timezone.
</li><li>Sergi Vladykin translated the error messages to Russian. Thanks a lot!
</li><li>Support for Java 6 DatabaseMetaData.getTables, getColumns, getProcedures, and getProcedureColumns.
</li><li>Issue 101: Rollback of a large transaction (more than 100000 rows) could fail.
</li><li>Various bugfixes and improvements in the page store mechanism (still experimental).
</li><li>The functions LENGTH, OCTET_LENGTH, and BIT_LENGTH now return BIGINT.
</li><li>Data types CLOB and BLOB: the maximum precision was Integer.MAX_VALUE, it is now Long.MAX_VALUE.
</li><li>Multi-threaded kernel: creating and dropping temporary database objects
    and the potentially free pages list was not correctly synchronized. Thanks a lot
    to Eric Faulhaber for the test case and patch!
</li><li>Parsing SQL script files is now faster.
</li><li>CSV reading is now faster.
</li><li>SimpleResultSet.newInstance(SimpleRowSource rs) did not work.
</li></ul>

<h2>Version 1.1.116 (2009-07-18)</h2>
<ul><li>Server-less multi-connection mode: more bugs are fixed.
</li><li>The built-in help (INFORMATION_SCHEMA.HELP) is smaller, shrinking the jar file size a bit.
</li><li>H2 Console: column of tables of non-default schemas are now also listed,
    except for schemas starting with 'INFO'.
</li><li>ALTER TABLE: removing an auto-increment or identity column didn't remove the sequence.
</li><li>Creating indexes is now a bit faster.
</li><li>PG Server: new system property h2.pgClientEncoding to explicitly set the encoding
    for clients that don't send the encoding (the default encoding is UTF-8).
    Thanks a lot to Sergi Vladykin for the patch!
</li><li>PG Server: improved compatibility by using the type ids of the PostgreSQL driver.
    Thanks a lot to Sergi Vladykin for the patch!
</li><li>H2 Console: Oracle system tables are no longer listed, improving performance.
</li><li>Result sets are now read-only except if the statement or prepared statement was created
    with the concurrency ResultSet.CONCUR_UPDATABLE. This change is required because the old behavior
    (all result set are updatable) violated the JDBC spec. For backward compatibility, use the
    system property h2.defaultResultSetConcurrency.
</li><li>New system property h2.defaultResultSetConcurrency to change the default result set concurrency.
</li><li>JDBC: using an invalid result set type or concurrency now throws an exception.
</li><li>If a pooled connection was not closed but garbage collected, a NullPointerException could occur.
</li><li>Fulltext search: a NullPointerException was thrown when updating a value that
    was NULL previously.
</li><li>The Recover tool did not work with .data.db files of the wrong size.
</li><li>Triggers: if there was an exception when initializing a trigger, this exception could be hidden,
    and in some cases (specially when using the Lucene fulltext index mechanism) a NullPointerException was
    thrown later on. Now the exception that occurred on init is thrown when changing data.
</li><li>The soft-references cache (CACHE_TYPE=SOFT_LRU) could throw a NullPointerException.
</li><li>To enable the new page store mechanism, append ;PAGE_STORE=TRUE to the database URL.
    or set the system property h2.pageStore to true.
    This mechanism is still experimental, and the file format will change, but it is quite stable now.
</li></ul>

<!-- [close] { --></div></td></tr></table><!-- } --><!-- analytics --></body></html>

